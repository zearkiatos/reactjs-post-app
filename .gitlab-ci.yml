image: docker
variables:
  DOCKER_DRIVER: overlay
services:
  - docker:dind

before_script:
  - docker info
  - apk update
  - apk upgrade
  - apk add python python-dev py-pip build-base libffi-dev openssl-dev
  - pip install docker-compose


stages:
  - build

build-app:
  stage: build
  variables:
    ENVIRONMENT: 'staging'
  script:
    - docker-compose up -d
  only:
    - branches